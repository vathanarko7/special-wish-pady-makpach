<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Khmer:wght@400;600;700&display=swap"
        rel="stylesheet">
    <title>áŸá¶ášá‡á¼á“á–ášá–á·áŸáŸáŸ â¤ï¸ğŸ§§</title>

    <style>
        :root {
            --w: min(92vw, 380px);
            --h: 520px;
            --pink: #ff3b7a;
            --pink2: #ff7fb0;
            --red: #b30000;
            --gold: #d4a017;
            --ink: #2a1020;
        }

        * {
            box-sizing: border-box;
        }

        /* âœ… Scrollable page on mobile */
        body {
            font-family: 'Noto Sans Khmer', system-ui, sans-serif;
            margin: 0;
            min-height: 100vh;
            /* font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; */
            color: var(--ink);
            display: flex;
            justify-content: center;
            background:
                radial-gradient(900px 600px at 20% 10%, #ffd6ea 0%, transparent 60%),
                radial-gradient(900px 600px at 80% 0%, #ffe7f2 0%, transparent 55%),
                radial-gradient(900px 600px at 50% 90%, #fff0f7 0%, transparent 55%),
                linear-gradient(135deg, #fff 0%, #fff6fb 50%, #fff 100%);
            overflow-x: hidden;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
        }

        /* background particles layer */
        #bgParticles {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 1;
            /* behind cards */
        }

        .stage {
            width: min(1100px, 96vw);
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 14px;
            padding: 18px 0 28px;
            /* âœ… breathing room top/bottom */
            position: relative;
            z-index: 5;
            /* above particles */
            transform: translateY(10px);
            opacity: 0;
            animation: appear .9s ease-out forwards;
        }

        @keyframes appear {
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* âœ… Buttons aligned: put them in same row, wrap nicely */
        .topbar {
            width: 100%;
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: 12px;
            padding: 0 8px;
        }

        .titleBlock {
            display: flex;
            flex-direction: column;
            gap: 6px;
        }

        h1 {
            margin: 0;
            font-size: clamp(20px, 3.3vw, 30px);
            letter-spacing: .2px;
        }

        .hint {
            margin: 0;
            opacity: .7;
            font-size: 13px;
            line-height: 1.25;
        }

        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: flex-end;
        }

        .pill {
            border: 1px solid rgba(42, 16, 32, .12);
            background: rgba(255, 255, 255, .72);
            backdrop-filter: blur(10px);
            border-radius: 999px;
            padding: 10px 12px;
            box-shadow: 0 14px 30px rgba(0, 0, 0, .10);
            cursor: pointer;
            user-select: none;
            font-weight: 700;
            font-size: 14px;
            white-space: nowrap;
        }

        .pill:active {
            transform: translateY(1px);
        }

        .grid {
            width: 100%;
            display: flex;
            gap: 26px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: stretch;
            padding: 0 10px 10px;
        }

        /* Flip Card */
        .flip {
            width: var(--w);
            height: var(--h);
            perspective: 1200px;
            opacity: 0;
            transform: translateY(18px) scale(.98);
            animation: cardIn .9s ease-out forwards;
        }

        .flip:nth-child(2) {
            animation-delay: .12s;
        }

        @keyframes cardIn {
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .flip-inner {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
            transition: transform .8s cubic-bezier(.2, .8, .2, 1);
        }

        .flip.is-flipped .flip-inner {
            transform: rotateY(180deg);
        }

        .face {
            position: absolute;
            inset: 0;
            border-radius: 26px;
            overflow: hidden;
            backface-visibility: hidden;
            box-shadow: 0 24px 70px rgba(0, 0, 0, .16);
            border: 1px solid rgba(0, 0, 0, .06);
            background: rgba(255, 255, 255, .85);
            backdrop-filter: blur(10px);
        }

        .back {
            transform: rotateY(180deg);
        }

        .frame {
            position: absolute;
            inset: 14px;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, .35);
            box-shadow: inset 0 0 0 1px rgba(0, 0, 0, .06);
            overflow: hidden;
        }

        .img {
            width: 100%;
            height: 62%;
            object-fit: cover;
            display: block;
            border-radius: 18px;
            border: 1px solid rgba(0, 0, 0, .06);
            box-shadow: 0 16px 40px rgba(0, 0, 0, .15);
        }

        .content {
            padding: 12px 6px 0;
            text-align: center;
        }

        .cardTitle {
            margin: 10px 0 6px;
            font-size: 22px;
            line-height: 1.15;
        }

        .text {
            margin: 0;
            font-size: 14.5px;
            line-height: 1.45;
            opacity: .85;
            padding: 0 6px;
        }

        .tap {
            margin: 10px 0 0;
            font-size: 12.5px;
            opacity: .65;
        }

        /* Themed borders */
        .valentine .face {
            border: 1px solid rgba(255, 59, 122, .18);
        }

        .valentine .frame {
            box-shadow:
                inset 0 0 0 1px rgba(255, 59, 122, .14),
                inset 0 0 0 10px rgba(255, 59, 122, .06);
        }

        .cny .face {
            border: 1px solid rgba(212, 160, 23, .22);
        }

        .cny .frame {
            box-shadow:
                inset 0 0 0 1px rgba(212, 160, 23, .18),
                inset 0 0 0 10px rgba(212, 160, 23, .07);
        }

        /* Back face styling */
        .backwrap {
            position: absolute;
            inset: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            padding: 20px;
        }

        .big {
            font-size: 24px;
            margin: 0;
            line-height: 1.12;
        }

        .note {
            margin: 10px 0 0;
            font-size: 14.5px;
            line-height: 1.5;
            opacity: .9;
        }

        .sig {
            margin-top: 10px;
            font-weight: 800;
            opacity: .8;
        }

        .badge {
            align-self: center;
            margin-top: 10px;
            display: inline-flex;
            gap: 8px;
            align-items: center;
            padding: 10px 12px;
            border-radius: 999px;
            background: rgba(255, 255, 255, .65);
            border: 1px solid rgba(0, 0, 0, .08);
            box-shadow: 0 12px 26px rgba(0, 0, 0, .10);
            font-weight: 800;
            font-size: 13.5px;
            text-align: center;
        }

        /* Decorative gradients on backs */
        .valentine .back {
            background:
                radial-gradient(500px 320px at 20% 20%, rgba(255, 59, 122, .20), transparent 55%),
                radial-gradient(500px 320px at 80% 10%, rgba(255, 127, 176, .18), transparent 55%),
                linear-gradient(135deg, rgba(255, 255, 255, .92), rgba(255, 240, 247, .90));
        }

        .cny .back {
            background:
                radial-gradient(500px 320px at 20% 20%, rgba(212, 160, 23, .18), transparent 55%),
                radial-gradient(500px 320px at 80% 10%, rgba(179, 0, 0, .18), transparent 55%),
                linear-gradient(135deg, rgba(255, 255, 255, .92), rgba(255, 248, 230, .90));
        }

        /* âœ… Mobile: stack top bar nicely */
        @media (max-width: 520px) {
            .topbar {
                flex-direction: column;
                align-items: stretch;
            }

            .controls {
                justify-content: flex-start;
            }
        }

        /* ---------- Background particle shapes ---------- */
        .p {
            position: absolute;
            left: var(--x);
            top: 110%;
            transform: translate(-50%, -50%) rotate(var(--r));
            animation: floatUp var(--dur) linear infinite;
            opacity: .9;
            filter: drop-shadow(0 10px 14px rgba(0, 0, 0, .12));
        }

        @keyframes floatUp {
            0% {
                transform: translate(calc(-50% + var(--dx1)), 0) rotate(var(--r));
                opacity: 0;
            }

            10% {
                opacity: .9;
            }

            50% {
                transform: translate(calc(-50% + var(--dx2)), -70vh) rotate(calc(var(--r) + 45deg));
                opacity: .9;
            }

            100% {
                transform: translate(calc(-50% + var(--dx3)), -135vh) rotate(calc(var(--r) + 90deg));
                opacity: 0;
            }
        }


        .heart {
            width: var(--s);
            height: var(--s);
            position: relative;
            transform: translate(-50%, -50%) rotate(45deg);
        }

        .heart::before,
        .heart::after {
            content: "";
            position: absolute;
            width: var(--s);
            height: var(--s);
            background: linear-gradient(135deg, var(--pink), var(--pink2));
            border-radius: 50%;
            top: 0;
            left: 0;
        }

        .heart::after {
            left: calc(var(--s) * -0.5);
        }

        .heart::before {
            top: calc(var(--s) * -0.5);
        }

        .lantern {
            width: calc(var(--s) * 0.85);
            height: var(--s);
            border-radius: 14px;
            background: linear-gradient(180deg, #ff4d4d, #b30000);
            border: 1px solid rgba(255, 255, 255, .25);
            position: relative;
            box-shadow: inset 0 0 0 2px rgba(255, 255, 255, .12);
        }

        .lantern::before {
            content: "";
            position: absolute;
            left: 50%;
            top: -10px;
            transform: translateX(-50%);
            width: 30%;
            height: 10px;
            border-radius: 6px 6px 2px 2px;
            background: linear-gradient(180deg, #ffd56a, #d4a017);
            border: 1px solid rgba(0, 0, 0, .08);
        }

        .lantern::after {
            content: "";
            position: absolute;
            left: 50%;
            bottom: -14px;
            transform: translateX(-50%);
            width: 2px;
            height: 14px;
            background: rgba(212, 160, 23, .9);
            box-shadow: 0 0 10px rgba(212, 160, 23, .35);
        }

        .coin {
            width: var(--s);
            height: var(--s);
            border-radius: 999px;
            background: radial-gradient(circle at 30% 30%, #fff2b3, #d4a017 60%, #b8860b);
            border: 1px solid rgba(0, 0, 0, .10);
            position: relative;
            box-shadow: inset 0 0 0 3px rgba(255, 255, 255, .18);
        }

        .coin::after {
            content: "";
            position: absolute;
            inset: 28%;
            border-radius: 999px;
            border: 2px solid rgba(179, 0, 0, .55);
            box-shadow: inset 0 0 0 2px rgba(255, 255, 255, .16);
        }
    </style>
</head>

<body>

    <!-- âœ… Combined background particles (hearts + lanterns + coins) -->
    <div id="bgParticles" aria-hidden="true"></div>

    <div class="stage">
        <div class="topbar">
            <div class="titleBlock">
                <h1>áŸá¶ášá‡á¼á“á–ášá–á·áŸáŸáŸ â¤ï¸ğŸ§§</h1>
                <p class="hint">á…á»á…áŠá¾á˜áŸ’á”á¸á”á¾á€á€á¶á â€¢ á…á»á… "á›áŸá„áá“áŸ’ááŸ’ášá¸" áŠá¾á˜áŸ’á”á¸áŸáŸ’áá¶á”áŸ‹ ğŸ¶</p>
            </div>

            <div class="controls">
                <button class="pill" id="musicBtn">á›áŸá„áá“áŸ’ááŸ’ášá¸ ğŸ¶</button>
                <button class="pill" id="flipAllBtn">á”á„áŸ’á á¶á‰á–áŸ’ášá˜á‚áŸ’á“á¶ ğŸ”„</button>
            </div>
        </div>

        <div class="grid">

            <!-- ğŸ’˜ VALENTINE -->
            <section class="flip valentine" id="valCard" aria-label="Valentine card">
                <div class="flip-inner">
                    <div class="face front">
                        <div class="frame">
                            <img class="img" src="/images/valentine.png" alt="Valentine photo">
                            <div class="content">
                                <h2 class="cardTitle">ášá¸á€ášá¶á™ááŸ’á„áŸƒá”á»ááŸ’á™á“áŸƒá€áŸ’áŠá¸áŸáŸ’ášá¡á¶á‰áŸ‹ ğŸ’–</h2>
                                <p class="text">
                                    áœááŸ’áá˜á¶á“ášá”áŸáŸ‹á¢áŸ’á“á€á‘á¶áŸ†á„á¢áŸáŸ‹á‚áŸ’á“á¶ á’áŸ’áœá¾á²áŸ’á™á‡á¸áœá·áááŸ’á‰á»áŸ†<br />á•áŸ’á¢áŸ‚á˜á›áŸ’á áŸ‚á˜ á“á·á„á˜á¶á“á“áŸá™áŸ”<br />
                                    áŸá¼á˜á‡á¼á“á–ášá‚áŸ’ášá½áŸá¶ášá”áŸ‰á¶áŒá¸á˜áŸ‰á¶á€áŸ‹á”áŸ‰á¶á…á²áŸ’á™á˜á¶á“á€áŸ’áŠá¸áŸáŸ’ášá¡á¶á‰áŸ‹á…áŸ’ášá¾á“áŸ—<br /> á€á€áŸ‹á€áŸ’ááŸ…á…á·ááŸ’á
                                    á“á·á„áŸá»á—á˜á„áŸ’á‚á›á‡á¶á“á·á…áŸ’á…áŸ”
                                </p>
                                <p class="tap">á…á»á…áŠá¾á˜áŸ’á”á¸á”á¾á€á€á¶á ğŸ’˜</p>
                            </div>
                        </div>
                    </div>

                    <div class="face back">
                        <div class="backwrap">
                            <div>
                                <p class="big">á‡á¼á“á…áŸ†á–áŸ„áŸ‡á‚áŸ’ášá½áŸá¶ášá”áŸ‰á¶áŒá¸á˜áŸ‰á¶á€áŸ‹á”áŸ‰á¶á… ğŸ’</p>
                                <p class="note">
                                    á”á¾ááŸ’á‰á»áŸ†á¢á¶á…á•áŸ’áá›áŸ‹á¢áŸ’áœá¸á˜á½á™á²áŸ’á™á¢áŸ’á“á€á”á¶á“<br />
                                    ááŸ’á‰á»áŸ†á“á¹á„á•áŸ’áá›áŸ‹á²áŸ’á™á¢áŸ’á“á€áƒá¾á‰ááŸ’á›á½á“á¢áŸ’á“á€áá¶á˜á€áŸ‚áœá—áŸ’á“áŸ‚á€ááŸ’á‰á»áŸ†<br />
                                    á–áŸ’ášáŸ„áŸ‡á¢áŸ’á“á€á“á¹á„áŠá¹á„áá¶ á¢áŸ’á“á€á–á·áŸáŸáŸá”áŸ‰á»ááŸ’áá¶áŸá˜áŸ’ášá¶á”áŸ‹ááŸ’á‰á»áŸ†áŸ”
                                </p>
                                <div class="badge">ğŸ’˜ á€áŸ’áá¸áŸáŸ’ášá›á¶á‰áŸ‹ â€¢ ğŸŒ¹ á“á¹á€ášá›á¹á€ â€¢ âœ¨ á‡á¶áŠášá¶á”</div>
                            </div>
                            <div class="sig">â€” áŠáŸ„á™á€áŸ’áá¸áŸáŸ’ášá›á¶á‰áŸ‹ á“á·á„á“á¹á€ášá›á¹á€á–á¸á…á˜áŸ’á„á¶á™ â¤ï¸</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ğŸ§§ CNY -->
            <section class="flip cny" id="cnyCard" aria-label="Chinese New Year card">
                <div class="flip-inner">
                    <div class="face front">
                        <div class="frame">
                            <img class="img" src="/images/family.png" alt="Family photo">
                            <div class="content">
                                <h2 class="cardTitle" style="color:var(--red);">áŸá½áŸáŸ’áá¸á†áŸ’á“á¶áŸ†ááŸ’á˜á¸ ğŸ§§</h2>
                                <p class="text">
                                    áŸá¼á˜á‡á¼á“á–ášá€áŸ’ášá»á˜á‚áŸ’ášá½áŸá¶ášá”áŸ‰á¶áŒá¸á˜áŸ‰á¶á€áŸ‹á”áŸ‰á¶á…
                                    á²áŸ’á™á˜á¶á“áŸá»áá—á¶á–á›áŸ’á¢<br /> áŸá»á—á˜á„áŸ’á‚á› á“á·á„áŸáŸ†áá¶á„á›áŸ’á¢á–áŸá‰á˜á½á™á†áŸ’á“á¶áŸ†áŸ”<br />
                                    æ–°å¹´å¿«ä¹ ğŸ§§ æ­å–œå‘è´¢
                                </p>
                                <p class="tap">á…á»á…áŠá¾á˜áŸ’á”á¸á”á¾á€á€á¶á ğŸ§§</p>
                            </div>
                        </div>
                    </div>

                    <div class="face back">
                        <div class="backwrap">
                            <div>
                                <p class="big" style="color:var(--red);">á‡á½á“á…áŸ†á–áŸ„áŸ‡á‚áŸ’ášá½áŸá¶ášá”áŸ‰á¶áŒá¸á˜áŸ‰á¶á€áŸ‹á”áŸ‰á¶á… ğŸ§§</p>
                                <p class="note">
                                    áŸá¼á˜á¢áŸ„á™á•áŸ’á‘áŸ‡ášá”áŸáŸ‹á™á¾á„ á–áŸ„ášá–áŸá‰áŠáŸ„á™áŸáŸá…á€áŸ’áá¸áŸá”áŸ’á”á¶á™ášá¸á€ášá¶á™ áŸáŸ†áá¶á„á›áŸ’á¢â€‹ á“á·á„áŸáŸá…á€áŸ’áá¸áŸá»áá‡á¶á“á·á…áŸ’á…áŸ”<br />
                                    á¢ášá‚á»ááŸá˜áŸ’ášá¶á”áŸ‹á€áŸ’áŠá¸áŸáŸ’ášá¡á¶á‰áŸ‹ á“á·á„á€á¶ášá‚á¶áŸ†á‘áŸ’ášášá”áŸáŸ‹á¢áŸ’á“á€á‘á¶áŸ†á„á¢áŸáŸ‹á‚áŸ’á“á¶ á‡á¶á–á·áŸáŸáŸá”áŸ‰á¶á˜áŸ‰á¶á€áŸ‹áŸ”
                                </p>
                                <div class="badge">ğŸ§§ áŸáŸ†áá¶á„á›áŸ’á¢ â€¢ âœ¨ áŸá»ááŸá¶á“áŸ’á â€¢ ğŸ’› ášá½á”ášá½á˜á‚áŸ’ášá½áŸá¶áš<br />ğŸ§§ å¥½è¿ â€¢ âœ¨ å¹³å®‰ â€¢ ğŸ’› å›¢åœ†
                                </div>
                            </div>
                            <div class="sig">â€” áŠáŸ„á™á€áŸ’áá¸áŸáŸ’ášá›á¶á‰áŸ‹ á“á·á„á“á¹á€ášá›á¹á€á–á¸á…á˜áŸ’á„á¶á™ ğŸ’›</div>
                        </div>
                    </div>
                </div>
            </section>

        </div>
    </div>

    <!-- background music -->
    <audio id="bgm" loop preload="auto">
        <source src="music.m4a" type="audio/mp4">
    </audio>

    <script>
        // Stop clicks on buttons from flipping cards (better in Messenger/IG browsers)
        document.querySelectorAll('button').forEach(btn => {
            btn.addEventListener('click', (e) => e.stopPropagation());
        });
        // ---------- Music ----------
        const bgm = document.getElementById('bgm');
        const musicBtn = document.getElementById('musicBtn');
        let musicOn = false;

        async function toggleMusic() {
            try {
                if (!musicOn) {
                    await bgm.play();
                    musicOn = true;
                    musicBtn.textContent = 'á€áŸ†á–á»á„á›áŸá„ ğŸ”Š';
                } else {
                    bgm.pause();
                    musicOn = false;
                    musicBtn.textContent = 'á›áŸá„áá“áŸ’ááŸ’ášá¸ ğŸ¶';
                }
            } catch (e) {
                musicBtn.textContent = 'á…á»á…á˜áŸ’áá„á‘áŸ€á ğŸ¶';
            }
        }
        musicBtn.addEventListener('click', toggleMusic);

        function startMusicIfPossible() {
            if (!musicOn) {
                bgm.play().then(() => {
                    musicOn = true;
                    musicBtn.textContent = 'á€áŸ†á–á»á„á›áŸá„ ğŸ”Š';
                }).catch(() => { });
            }
        }

        // ---------- Flip behavior ----------
        const valCard = document.getElementById('valCard');
        const cnyCard = document.getElementById('cnyCard');
        const flipAllBtn = document.getElementById('flipAllBtn');

        function flip(card) {
            card.classList.toggle('is-flipped');
            startMusicIfPossible();
        }
        valCard.addEventListener('click', () => flip(valCard));
        cnyCard.addEventListener('click', () => flip(cnyCard));
        flipAllBtn.addEventListener('click', () => {
            valCard.classList.toggle('is-flipped');
            cnyCard.classList.toggle('is-flipped');
            startMusicIfPossible();
        });

        // ---------- Background Particles (optimized) ----------
        const layer = document.getElementById('bgParticles');
        const reduceMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

        function rand(min, max) { return Math.random() * (max - min) + min; }

        function makeParticle(kind, sizePx) {
            const p = document.createElement('div');
            p.className = 'p';
            p.style.setProperty('--s', `${sizePx}px`);
            p.style.setProperty('--x', `${rand(4, 96)}%`);
            p.style.setProperty('--r', `${rand(-40, 40)}deg`);
            p.style.setProperty('--dur', `${rand(8.5, 15.5)}s`);
            p.style.setProperty('--dx1', `${rand(-14, 14)}px`);
            p.style.setProperty('--dx2', `${rand(-46, 46)}px`);
            p.style.setProperty('--dx3', `${rand(-18, 18)}px`);

            const inner = document.createElement('div');
            inner.className = kind;
            p.appendChild(inner);

            layer.appendChild(p);
            setTimeout(() => p.remove(), 16000);
        }

        let running = true;
        document.addEventListener('visibilitychange', () => {
            running = !document.hidden;
        });

        // One scheduler loop instead of 3 intervals
        let lastHeart = 0, lastLantern = 0, lastCoin = 0;

        function particleLoop(t) {
            if (!reduceMotion && running) {
                // lower rates = smoother on in-app browsers
                if (t - lastHeart > 520) { makeParticle('heart', rand(14, 22)); lastHeart = t; }
                if (t - lastLantern > 980) { makeParticle('lantern', rand(18, 28)); lastLantern = t; }
                if (t - lastCoin > 760) { makeParticle('coin', rand(14, 22)); lastCoin = t; }
            }
            requestAnimationFrame(particleLoop);
        }
        requestAnimationFrame(particleLoop);

    </script>

</body>

</html>